$schema: http://json-schema.org/schema#
title: "#! userdb -- Schema for user records auxiliary data"
type: object
properties:
  ssh_keys:
    type: array
    items: {$ref: '#/definitions/ssh_key'}
    uniqueItems: True
    description: SSH keys for the shell servers
  name:
    type: string
    description: "User's name (GECOS)"
  shell:
    type: string
    description: "User's login shell"
    
definitions:
  ssh_key:
    type: string
    description: A valid rsa, dsa, or ecdsa key compatible with sshd.
    pattern: '^(ssh-(rsa|dss|ed25519)|ecdsa-sha2-nistp(256|384|521)) [a-zA-Z0-9/+=]{8,4000}( .*)?$'

required: [ssh_keys, shell]
